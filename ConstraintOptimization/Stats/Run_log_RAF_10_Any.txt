Using device: cuda
Checkpoint for run 2 already exists. Skipping Gurobi edit.
Loaded model for run 2 from checkpoint.
Saved FC inputs for run 2.
Training and Validation Accuracy before Gurobi optimization: 97.6175 92.37
Training and Validation Accuracy of loaded inputs: (np.float64(0.9767), np.float64(0.9221))
Loaded inputs for Gurobi optimization.
Set parameter Username
Set parameter LicenseID to value 2677321
Academic license - for non-commercial use only - expires 2026-06-11
Set parameter TimeLimit to value 10800
Size of X: (1000, 256)
Size of W: (10, 256)
Size of b: (10,)
Mismatch:  0
Gurobi Optimizer version 12.0.2 build v12.0.2rc0 (linux64 - "Ubuntu 18.04.6 LTS")

CPU model: Intel(R) Core(TM) i7-8700K CPU @ 3.70GHz, instruction set [SSE2|AVX|AVX2]
Thread count: 6 physical cores, 12 logical processors, using up to 12 threads

Non-default parameters:
TimeLimit  10800

Optimize a model with 18142 rows, 26140 columns and 2231370 nonzeros
Model fingerprint: 0x37eea5c9
Model has 18000 simple general constraints
  18000 INDICATOR
Variable types: 15140 continuous, 11000 integer (11000 binary)
Coefficient statistics:
  Matrix range     [5e-09, 9e+00]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [6e-04, 2e+01]
  GenCon rhs range [1e-05, 1e-05]
  GenCon coe range [1e+00, 1e+00]
Presolve added 25999 rows and 26000 columns
Presolve time: 1.59s
Presolved: 44141 rows, 52140 columns, 2297800 nonzeros
Presolved model has 18000 SOS constraint(s)
Variable types: 33140 continuous, 19000 integer (19000 binary)
Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.00s

Barrier statistics:
 AA' NZ     : 0.000e+00
 Factor NZ  : 1.000e+00
 Factor Ops : 1.000e+00 (less than 1 second per iteration)
 Threads    : 1

Barrier performed 0 iterations in 1.96 seconds (2.16 work units)
Barrier solve interrupted - model solved by another algorithm

Concurrent spin time: 0.00s

Solved with primal simplex

Root relaxation: objective 0.000000e+00, 0 iterations, 0.31 seconds (0.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

H    0     0                     143.8128187    0.00000   100%     -    7s
     0     0    0.00000    0   90  143.81282    0.00000   100%     -   14s
     0     2    0.00000    0   90  143.81282    0.00000   100%     -   17s
    13    26    0.00000    4   86  143.81282    0.00000   100%   133   20s
    91    98    0.00000   10   80  143.81282    0.00000   100%   108   25s
   157   164    7.11694   16   84  143.81282    0.00000   100%  95.0   30s
   211   218    0.00000   20   70  143.81282    0.00000   100%  96.4   35s
   261   279    0.00000   24   66  143.81282    0.00000   100%   102   40s
   303   315    0.00000   29   61  143.81282    0.00000   100%   102   45s
   357   371    6.78909   35   64  143.81282    0.00000   100%  96.9   50s
   423   437    5.42240   37  104  143.81282    0.00000   100%  94.0   55s
   495   502    5.46018   41   73  143.81282    0.00000   100%  88.5   61s
   507   514    0.00000   42   48  143.81282    0.00000   100%  87.1   83s
   513   558    0.00000   43   47  143.81282    0.00000   100%  87.5   85s
   599   610    0.00000   48   42  143.81282    0.00000   100%  86.6   90s
   641   655    5.53168   50   49  143.81282    0.00000   100%  90.6   96s
   675   682    0.00000   51   39  143.81282    0.00000   100%  93.6  100s
   718   725    0.00000   56   34  143.81282    0.00000   100%   101  107s
   738   765    4.60608   57   38  143.81282    0.00000   100%   105  112s
   793   802    0.00000   58   32  143.81282    0.00000   100%   113  117s
   832   838    5.22822   59   35  143.81282    0.00000   100%   115  127s
   837   876    8.03905   60   85  143.81282    0.00000   100%   116  130s
   902   944    0.00000   61   29  143.81282    0.00000   100%   117  135s
   982  1032    2.47822   62   57  143.81282    0.00000   100%   119  142s
  1031  1060    0.00000   62   28  143.81282    0.00000   100%   119  146s
  1127  1167    0.00000   64   27  143.81282    0.00000   100%   117  153s
  1166  1245    0.00000   65   27  143.81282    0.00000   100%   117  156s
  1244  1290    6.05475   72  131  143.81282    0.00000   100%   115  160s
  1375  1455    0.00000   79   24  143.81282    0.00000   100%   113  168s
  1454  1568    0.00000   82   23  143.81282    0.00000   100%   112  172s
  1567  1642    0.00000   92   23  143.81282    0.00000   100%   109  177s
  1641  1749    0.00000   93   23  143.81282    0.00000   100%   109  181s
* 1716  1707             141      46.9378799    0.00000   100%   108  185s
* 1748  1503             129      38.7680454    0.00000   100%   107  188s
  1754  1556    0.00000  101   23   38.76805    0.00000   100%   107  193s
  1927  1636    0.00000  116   23   38.76805    0.00000   100%   101  198s
  2113  1671    0.00000  134   23   38.76805    0.00000   100%  94.7  214s
  2222  1704    0.00000  137   23   38.76805    0.00000   100%  91.8  258s
* 2288  1666             191      38.0253406    0.00000   100%  90.6  258s
  2301  1761    8.25929  137   53   38.02534    0.00000   100%  90.2  264s
  2522  1870    7.41306  156   33   38.02534    0.00000   100%  85.3  270s
  2751  2004    0.00000  176   23   38.02534    0.00000   100%  81.0  276s
  2979  2117    0.00000  201   23   38.02534    0.00000   100%  77.9  282s
  3210  2245    6.07271  222   37   38.02534    0.00000   100%  74.9  289s
  3464  2250    0.00000  246   23   38.02534    0.00000   100%  71.9  340s
  3471  2381    0.00000  247   23   38.02534    0.00000   100%  71.8  346s
  3726  2503    1.24582  272   26   38.02534    0.00000   100%  69.4  353s
  3990  2627   10.77217  296   66   38.02534    0.00000   100%  67.3  360s
  4262  2762   10.44954  322   52   38.02534    0.00000   100%  65.2  367s
  4549  2899    0.00000  346   23   38.02534    0.00000   100%  63.2  374s
  4832  3040    9.21430  368   88   38.02534    0.00000   100%  61.7  382s
  5123  3189    8.00079  392   86   38.02534    0.00000   100%  60.3  390s
* 5437  3163             515      37.9199199    0.00000   100%  58.8  390s
  5438  3337    0.00000  421   23   37.91992    0.00000   100%  58.8  398s
* 5644  3077             516      36.4865261    0.00000   100%  58.0  402s
  5762  3198    0.00000  452   23   36.48653    0.00000   100%  57.5  410s
  6121  3376    0.00000  485   23   36.48653    0.00000   100%  55.8  419s
* 6354  3360             588      36.3835788    0.00000   100%  55.2  419s
  6464  3361   29.97864  121    0   36.38358    0.00000   100%  55.1  536s
  6466  3362   28.60180  426   20   36.38358    0.00000   100%  55.1  576s
  6467  3363    5.47269  283   20   36.38358    0.00000   100%  55.1  601s
  6468  3364   29.84206   64   20   36.38358    0.00000   100%  55.1  610s
  6469  3364   28.66018  442   20   36.38358    0.00000   100%  55.1  618s
  6470  3365   28.11708  197   20   36.38358    0.00000   100%  55.1  648s
  6471  3366   31.30148  144   20   36.38358    0.00000   100%  55.1  699s
  6472  3366   11.67804   56   20   36.38358    0.00000   100%  55.1  722s
  6473  3367   29.23558  282   20   36.38358    0.00000   100%  55.1  725s
  6475  3370    0.00000   16   22   36.38358    0.00000   100%  64.6  736s
  6476  3372    0.00000   17   20   36.38358    0.00000   100%  64.6  755s
  6478  3374    0.00000   18   22   36.38358    0.00000   100%  66.8  777s
  6481  3377    0.00000   19   20   36.38358    0.00000   100%  67.8  794s
  6485  3379    0.00000   20   20   36.38358    0.00000   100%  67.9  815s
  6488  3405    0.00000   21   20   36.38358    0.00000   100%  67.9  831s
  6515  3401    8.23626   23   34   36.38358    0.00000   100%  69.8  842s
  6520  3405    0.00000   24   22   36.38358    0.00000   100%  69.8  853s
  6526  3408    0.00000   25   22   36.38358    0.00000   100%  69.9  865s
  6531  3417    0.00000   26   22   36.38358    0.00000   100%  69.9  876s
  6541  3419    6.73027   28  155   36.38358    0.00000   100%  70.7  890s
  6547  3421    8.23626   29   10   36.38358    0.00000   100%  70.9  906s
  6551  3424    0.00000   29   22   36.38358    0.00000   100%  72.7  922s
  6555  3430    0.00000   30   22   36.38358    0.00000   100%  72.9  931s
  6562  3431    0.00000   31   22   36.38358    0.00000   100%  73.4  946s
  6566  3435    0.00000   32   22   36.38358    0.00000   100%  73.7  960s
  6571  3439    0.00000   33   22   36.38358    0.00000   100%  74.1  974s
  6577  3443    0.00000   34   22   36.38358    0.00000   100%  74.2  992s
  6583  3443    8.23626   34    2   36.38358    0.00000   100%  74.8 1009s
* 6585  3274              32      11.6054239    0.00000   100%  74.9 1010s
  6587  3270    0.00000   35   22   11.60542    0.00000   100%  75.0 1039s
* 6588  3110              35       8.3792654    0.00000   100%  75.0 1040s
  6606  3100    0.00000   36   22    8.37927    0.00000   100%  80.6 1060s
  6616  3103    0.00000   37   22    8.37927    0.00000   100%  81.0 1080s
  6625  3107    6.58476   33  137    8.37927    0.00000   100%  81.3 1109s
  6640  3108    6.58476   37  133    8.37927    0.00000   100%  84.5 1136s
  6646  3110     cutoff   38         8.37927    0.00000   100%  84.6 1162s
  6660  3108     cutoff   39         8.37927    0.00000   100%  88.2 1189s
  6678  3104     cutoff   40         8.37927    0.00000   100%  97.5 1222s
  6688  3105     cutoff   41         8.37927    0.00000   100%   100 1244s
  6704  3101    6.58476   42  133    8.37927    0.00000   100%   106 1281s
  6730  3094    6.58476   43  133    8.37927    0.00000   100%   110 1307s
  6740  3105     cutoff   44         8.37927    0.00000   100%   113 1342s
  6776  3096    7.14083   51   14    8.37927    0.00000   100%   115 1381s
  6810  3099    6.72777   40  123    8.37927    0.00000   100%   121 1409s
  6835  3098    6.72777   41  123    8.37927    0.00000   100%   128 1438s
* 6863  2937              61       7.3160681    0.00000   100%   133 1439s
  6866  2935    4.54079   36  142    7.31607    0.00000   100%   134 1470s
  6878  2950    4.54079   37  150    7.31607    0.00000   100%   140 1496s
  6929  2934     cutoff   38         7.31607    0.00000   100%   147 1528s
  6947  2928    4.54079   39  146    7.31607    0.00000   100%   148 1567s
  6966  2924     cutoff   39         7.31607    0.00000   100%   153 1600s
  6996  2914     cutoff   38         7.31607    0.00000   100%   158 1642s
  7019  2914    5.35958   39  122    7.31607    0.00000   100%   163 1678s
  7042  2910    5.35958   40  118    7.31607    0.00000   100%   164 1733s
  7059  2912    5.35958   41  114    7.31607    0.00000   100%   164 1775s
  7082  2913     cutoff   45         7.31607    0.00000   100%   167 1814s
  7109  2905    6.16303   54  134    7.31607    0.00000   100%   169 1875s
  7118  2908    6.16303   55  130    7.31607    0.00000   100%   170 1933s
  7124  2909     cutoff   55         7.31607    0.00000   100%   170 2017s
H 7125  2764                       2.6432420    0.00000   100%   170 2018s
H 7126  2626                       1.6047808    0.00000   100%   170 2018s
  7133  2577     cutoff   56         1.60478    0.00000   100%   170 2055s
  7209  2559    0.00000   59   22    1.60478    0.00000   100%   178 2093s
  7272  2543    0.00000   63   22    1.60478    0.00000   100%   190 2140s
  7281  2558    0.00000   65   22    1.60478    0.00000   100%   195 2192s
  7303  2568    0.00000   68   22    1.60478    0.00000   100%   195 2245s
  7334  2598    0.00000   70   22    1.60478    0.00000   100%   201 2294s
  7430  2612    0.00000   74   22    1.60478    0.00000   100%   211 2338s
  7540  2597    0.00000   92   22    1.60478    0.00000   100%   215 2388s
  7601  2555    0.00000   96   22    1.60478    0.00000   100%   222 2434s
  7660  2532    0.00000   97   22    1.60478    0.00000   100%   228 2492s
  7732  2535     cutoff  101         1.60478    0.00000   100%   238 2543s
  7838  2513    1.10044   64   20    1.60478    0.00000   100%   243 2602s
  7970  2495    1.10044  104   20    1.60478    0.00000   100%   249 2660s
  8098  2498    1.10044  111   20    1.60478    0.00000   100%   255 2746s
  8177  2477    1.10044  115   20    1.60478    0.00000   100%   261 2832s
  8184  2479    1.10044  116   20    1.60478    0.00000   100%   261 2958s
  8192  2479    1.10044  117   20    1.60478    0.00000   100%   261 3071s
  8200  2480    1.10044  118   20    1.60478    0.00000   100%   261 3177s
  8206  2484    1.10044  119   20    1.60478    0.00000   100%   261 3313s
  8212  2483    1.10044  120   20    1.60478    0.00000   100%   261 3486s
  8222  2484    1.10044  121   20    1.60478    0.00000   100%   263 3633s
  8230  2505    1.10044  122   20    1.60478    0.00000   100%   263 3752s
  8296  2531    1.10044  131   20    1.60478    0.00000   100%   268 3880s
H 8393  2436                       1.6047808    0.00000   100%   275 4002s
  8611  2382     cutoff   73         1.60478    0.00000   100%   288 4134s
H 8693  2195                       1.1874874    0.00000   100%   293 4239s
  8782  2389    1.17546  158   18    1.18749    0.00000   100%   297 4329s
  9223  2454    0.36251   93   14    1.18749    0.00000   100%   302 4413s
  9581  2580     cutoff  214         1.18749    0.00000   100%   304 4504s
H 9997  2213                       1.1342483    0.00000   100%   302 4609s
 10191  2421    0.00000  241   20    1.13425    0.00000   100%   301 4720s
 10622  2614     cutoff   89         1.13425    0.00000   100%   301 4877s
 11300  2677    0.00000  315   20    1.13425    0.00000   100%   306 5024s
H11421  2524                       1.1139198    0.00000   100%   304 5024s
H11571  2132                       0.8933425    0.00000   100%   302 5025s
 11724  2237    0.38678  436   16    0.89334    0.00000   100%   302 5172s
 12288  2637    0.00000   79   22    0.89334    0.00000   100%   307 5307s
 13183  2861     cutoff  216         0.89334    0.00000   100%   300 5592s
 13847  3024     cutoff  171         0.89334    0.00000   100%   303 5690s
 14277  3207     cutoff  268         0.89334    0.00000   100%   303 5781s
 14718  3432     cutoff  279         0.89334    0.00000   100%   302 5867s
 15160  3590    0.10774  281   18    0.89334    0.00000   100%   299 5957s
 15572  3780    0.49135  431   18    0.89334    0.00000   100%   297 6047s
 15974  3761     cutoff  241         0.89334    0.00000   100%   297 6141s
 15999  3785     cutoff  398         0.89334    0.00000   100%   299 6265s
 16113  3897     cutoff  255         0.89334    0.00000   100%   302 6354s
 16418  4104     cutoff  359         0.89334    0.00000   100%   306 6465s
 16797  4265     cutoff  267         0.89334    0.00000   100%   308 6580s
 17236  4419     cutoff  310         0.89334    0.00000   100%   309 6701s
 17683  4489     cutoff  206         0.89334    0.00000   100%   309 6829s
H17708  4370                       0.8277355    0.00000   100%   310 6830s
 17964  4572    0.00000  166   22    0.82774    0.00000   100%   311 6963s
 18530  4632    0.00000  193   20    0.82774    0.00000   100%   314 7101s
 18870  4771    0.00000  248   20    0.82774    0.00000   100%   317 7258s
 19171  4887    0.00000  252   20    0.82774    0.00000   100%   319 7412s
 19577  4993     cutoff  250         0.82774    0.00000   100%   321 7573s
 19963  5202     cutoff  391         0.82774    0.00000   100%   325 7743s
 20538  5468    0.00000  157   22    0.82774    0.00000   100%   329 7921s
 21240  5581    0.00000  277   22    0.82774    0.00000   100%   330 8098s
 21810  5690     cutoff  171         0.82774    0.00000   100%   333 8277s
 22314  5810     cutoff  227         0.82774    0.00000   100%   336 8462s
 22906  5918     cutoff  246         0.82774    0.00000   100%   339 8648s
 23375  6194     cutoff  140         0.82774    0.00000   100%   342 8837s
H24121  3936                       0.7183319    0.00000   100%   343 8837s
 24165  3796     cutoff  244         0.71833    0.00000   100%   343 9010s
 24393  3781     cutoff  215         0.71833    0.00000   100%   347 9283s
 24488  3884     cutoff  243         0.71833    0.00000   100%   349 9459s
H24660  3636                       0.6874140    0.00000   100%   349 9460s
 24812  3782    0.59431  246   18    0.68741    0.00000   100%   352 9648s
 25361  3918    0.00000  332   22    0.68741    0.00000   100%   356 9837s
H25976  3569                       0.5294174    0.00000   100%   362 10768s
 26525  3555     cutoff  258         0.52942    0.00000   100%   369 10800s

Cutting planes:
  Gomory: 13

Explored 26537 nodes (9796958 simplex iterations) in 10800.16 seconds (21253.70 work units)
Thread count was 12 (of 12 available processors)

Solution count 10: 0.529417 0.687414 0.718332 ... 2.64324

Time limit reached
Best objective 5.294174026530e-01, best bound 0.000000000000e+00, gap 100.0000%
Total misclassified samples: 10
Epoch [1/100], Train Loss: 0.0816, Train Acc: 97.36%
Epoch [2/100], Train Loss: 0.0685, Train Acc: 97.76%
Epoch [3/100], Train Loss: 0.0612, Train Acc: 97.97%
Epoch [4/100], Train Loss: 0.0530, Train Acc: 98.26%
Epoch [5/100], Train Loss: 0.0456, Train Acc: 98.56%
Epoch [6/100], Train Loss: 0.0383, Train Acc: 98.78%
Epoch [7/100], Train Loss: 0.0364, Train Acc: 98.85%
Epoch [8/100], Train Loss: 0.0327, Train Acc: 98.98%
Epoch [9/100], Train Loss: 0.0288, Train Acc: 99.12%
Epoch [10/100], Train Loss: 0.0256, Train Acc: 99.16%
Epoch [11/100], Train Loss: 0.0255, Train Acc: 99.22%
Early stopping at epoch 11. Best was epoch 1 (val_loss=0.2329).
Restored best model from epoch 1.
Test Accuracy: 92.27%
